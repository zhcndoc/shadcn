---
title: 表单 Form
description: 使用 React Hook Form 和 Zod 构建表单。
links:
  doc: https://react-hook-form.com
---

import { InfoIcon } from "lucide-react"

<Callout icon={<InfoIcon />} title="我们不再积极维护此组件。">

Form 组件是对 `react-hook-form` 库的抽象。今后，我们推荐使用 [`<Field />`](/docs/components/field) 组件来构建表单。有关更多信息，请参阅 [Form](/docs/forms) 文档。

</Callout>

表单很棘手。它们是你在 web 应用中最常见的构建内容之一，同时也是最复杂的之一。

设计良好的 HTML 表单应该：

- 结构良好且语义正确。
- 易于使用和导航（键盘操作）。
- 通过 ARIA 属性和正确标签实现无障碍。
- 支持客户端和服务器端验证。
- 样式良好且与应用其他部分风格统一。

在本指南中，我们将看如何使用 [`react-hook-form`](https://react-hook-form.com/) 和 [`zod`](https://zod.dev) 构建表单。我们将使用 `<FormField>` 组件，结合 Radix UI 组件，来组合可访问的表单。

## 功能

`<Form />` 组件是对 `react-hook-form` 库的封装。它提供了以下功能：

- 用于构建表单的可组合组件。
- 用于构建受控表单字段的 `<FormField />` 组件。
- 使用 `zod` 进行表单验证。
- 处理无障碍和错误消息。
- 使用 `React.useId()` 生成唯一 ID。
- 根据状态为表单字段应用正确的 `aria` 属性。
- 兼容所有 Radix UI 组件。
- 你可以带入自己的 schema 库。我们使用 `zod`，但你也可以用任何你想要的方式。
- **你完全控制标记和样式。**

## 结构示意

```tsx showLineNumbers
<Form>
  <FormField
    control={...}
    name="..."
    render={() => (
      <FormItem>
        <FormLabel />
        <FormControl>
          { /* 你的表单字段 */ }
        </FormControl>
        <FormDescription />
        <FormMessage />
      </FormItem>
    )}
  />
</Form>
```

## 示例

```tsx showLineNumbers
const form = useForm()

<FormField
  control={form.control}
  name="username"
  render={({ field }) => (
    <FormItem>
      <FormLabel>用户名</FormLabel>
      <FormControl>
        <Input placeholder="shadcn" {...field} />
      </FormControl>
      <FormDescription>这是你的公开显示名称。</FormDescription>
      <FormMessage />
    </FormItem>
  )}
/>
```

## 安装

<CodeTabs>

<TabsList>
  <TabsTrigger value="cli">命令行</TabsTrigger>
  <TabsTrigger value="manual">手动</TabsTrigger>
</TabsList>
<TabsContent value="cli">

<Steps>

### 命令

```bash
npx shadcn@latest add form
```

</Steps>

</TabsContent>

<TabsContent value="manual">

<Steps>

<Step>安装以下依赖：</Step>

```bash
npm install @radix-ui/react-label @radix-ui/react-slot react-hook-form @hookform/resolvers zod
```

<Step>将以下代码复制粘贴到你的项目中。</Step>

<ComponentSource name="form" title="components/ui/form.tsx" />

<Step>更新导入路径以匹配你的项目配置。</Step>

</Steps>

</TabsContent>

</CodeTabs>

## 使用方法

### 创建表单 schema

使用 Zod schema 定义你的表单结构。你可以在 [Zod 文档](https://zod.dev) 中了解更多关于 Zod 的使用。

```tsx showLineNumbers title="components/example-form.tsx" {3,5-7}
"use client"

import { z } from "zod"

const formSchema = z.object({
  username: z.string().min(2).max(50),
})
```

### 定义表单

使用 `react-hook-form` 的 `useForm` 钩子创建表单。

```tsx showLineNumbers title="components/example-form.tsx" {3-4,14-20,22-27}
"use client"

import { zodResolver } from "@hookform/resolvers/zod"
import { useForm } from "react-hook-form"
import { z } from "zod"

const formSchema = z.object({
  username: z.string().min(2, {
    message: "用户名至少需要2个字符。",
  }),
})

export function ProfileForm() {
  // 1. 定义表单。
  const form = useForm<z.infer<typeof formSchema>>({
    resolver: zodResolver(formSchema),
    defaultValues: {
      username: "",
    },
  })

  // 2. 定义提交处理函数。
  function onSubmit(values: z.infer<typeof formSchema>) {
    // 处理表单值
    // ✅ 此处类型安全且已验证
    console.log(values)
  }
}
```

由于 `FormField` 使用的是受控组件，需要为字段提供默认值。详情请参阅 [React Hook Form 文档](https://react-hook-form.com/docs/usecontroller) 了解受控组件。

### 构建表单

现在我们可以使用 `<Form />` 组件来构建表单。

```tsx showLineNumbers title="components/example-form.tsx" {7-17,28-50}
"use client"

import { zodResolver } from "@hookform/resolvers/zod"
import { useForm } from "react-hook-form"
import { z } from "zod"

import { Button } from "@/components/ui/button"
import {
  Form,
  FormControl,
  FormDescription,
  FormField,
  FormItem,
  FormLabel,
  FormMessage,
} from "@/components/ui/form"
import { Input } from "@/components/ui/input"

const formSchema = z.object({
  username: z.string().min(2, {
    message: "用户名至少需要2个字符。",
  }),
})

export function ProfileForm() {
  // ...

  return (
    <Form {...form}>
      <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-8">
        <FormField
          control={form.control}
          name="username"
          render={({ field }) => (
            <FormItem>
              <FormLabel>用户名</FormLabel>
              <FormControl>
                <Input placeholder="shadcn" {...field} />
              </FormControl>
              <FormDescription>
                这是你的公开显示名称。
              </FormDescription>
              <FormMessage />
            </FormItem>
          )}
        />
        <Button type="submit">提交</Button>
      </form>
    </Form>
  )
}
```

### 完成

就这样。你现在拥有了一个具有类型安全和客户端验证功能的完全可访问表单。
