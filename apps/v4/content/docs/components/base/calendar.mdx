---
title: 日历
description: 一个允许用户选择单个日期或日期范围的日历组件。
base: base
component: true
links:
  doc: https://react-day-picker.js.org
---

<ComponentPreview
  styleName="base-nova"
  name="calendar-demo"
  previewClassName="h-96"
/>

## 安装

<CodeTabs>

<TabsList>
  <TabsTrigger value="cli">命令</TabsTrigger>
  <TabsTrigger value="manual">手动</TabsTrigger>
</TabsList>
<TabsContent value="cli">

```bash
npx shadcn@latest add calendar
```

</TabsContent>

<TabsContent value="manual">

<Steps className="mb-0 pt-2">

<Step>安装以下依赖项：</Step>

```bash
npm install react-day-picker date-fns
```

<Step>将 `Button` 组件添加到您的项目中。</Step>

`Calendar` 组件使用了 `Button` 组件。请确保您的项目中已安装该组件。

<Step>将以下代码复制并粘贴到您的项目中。</Step>

<ComponentSource
  name="calendar"
  title="components/ui/calendar.tsx"
  styleName="base-nova"
/>

<Step>根据您的项目设置更新导入路径。</Step>

</Steps>

</TabsContent>

</CodeTabs>

## 用法

```tsx showLineNumbers
import { Calendar } from "@/components/ui/calendar"
```

```tsx showLineNumbers
const [date, setDate] = React.useState<Date | undefined>(new Date())

return (
  <Calendar
    mode="single"
    selected={date}
    onSelect={setDate}
    className="rounded-lg border"
  />
)
```

更多信息请参阅 [React DayPicker](https://react-day-picker.js.org) 文档。

## 关于

`Calendar` 组件基于 [React DayPicker](https://react-day-picker.js.org) 构建。

## 日期选择器

您可以使用 `<Calendar>` 组件构建日期选择器。详见 [日期选择器](/docs/components/base/date-picker) 页面。

## 波斯历 / 伊斯兰历 / 贾拉利历

要使用波斯历，请编辑 `components/ui/calendar.tsx`，将 `react-day-picker` 替换为 `react-day-picker/persian`。

```diff
- import { DayPicker } from "react-day-picker"
+ import { DayPicker } from "react-day-picker/persian"
```

<ComponentPreview
  styleName="base-nova"
  name="calendar-hijri"
  title="波斯历 / 伊斯兰历 / 贾拉利历"
  description="一个波斯历日历。"
  previewClassName="h-[400px]"
/>

## 选定日期（含时区）

Calendar 组件支持 `timeZone` 属性，确保日期在用户本地时区正确显示和选择。

```tsx showLineNumbers
export function CalendarWithTimezone() {
  const [date, setDate] = React.useState<Date | undefined>(undefined)
  const [timeZone, setTimeZone] = React.useState<string | undefined>(undefined)

  React.useEffect(() => {
    setTimeZone(Intl.DateTimeFormat().resolvedOptions().timeZone)
  }, [])

  return (
    <Calendar
      mode="single"
      selected={date}
      onSelect={setDate}
      timeZone={timeZone}
    />
  )
}
```

**注意：** 如果您发现所选日期有偏移（例如选中 20 号时高亮显示了 19 号），请确保 `timeZone` 属性设置为用户的本地时区。

**为什么要在客户端？** 由于使用了 `Intl.DateTimeFormat().resolvedOptions().timeZone` 来检测时区，因此该操作放在了 `useEffect` 中以保证与服务端渲染兼容。如果在渲染时检测时区，可能会导致服务器和客户端时区不同步，从而引起水合错误。

## 示例

### 基础示例

一个基础的日历组件。我们使用了 `className="rounded-lg border"` 来美化日历。

<ComponentPreview
  styleName="base-nova"
  name="calendar-basic"
  previewClassName="h-96"
/>

### 范围选择日历

使用 `mode="range"` 属性启用范围选择。

<ComponentPreview
  styleName="base-nova"
  name="calendar-range"
  previewClassName="h-[36rem] md:h-96"
/>

### 月份和年份选择器

使用 `captionLayout="dropdown"` 来显示月份和年份下拉菜单。

<ComponentPreview
  styleName="base-nova"
  name="calendar-caption"
  previewClassName="h-96"
/>

### 预设

<ComponentPreview
  styleName="base-nova"
  name="calendar-presets"
  previewClassName="h-[650px]"
/>

### 日期和时间选择器

<ComponentPreview
  styleName="base-nova"
  name="calendar-time"
  previewClassName="h-[600px]"
/>

### 已预订日期

<ComponentPreview
  styleName="base-nova"
  name="calendar-booked-dates"
  previewClassName="h-96"
/>

### 自定义单元格大小

<ComponentPreview
  styleName="base-nova"
  name="calendar-custom-days"
  title="自定义单元格大小"
  description="具有响应式自定义单元格大小的日历。"
  className="**:[.preview]:h-[560px]"
/>

您可以使用 CSS 变量 `--cell-size` 自定义日历单元格的大小。也可以通过断点特定值实现响应式：

```tsx showLineNumbers
<Calendar
  mode="single"
  selected={date}
  onSelect={setDate}
  className="rounded-lg border [--cell-size:--spacing(11)] md:[--cell-size:--spacing(12)]"
/>
```

或者使用固定值：

```tsx showLineNumbers
<Calendar
  mode="single"
  selected={date}
  onSelect={setDate}
  className="rounded-lg border [--cell-size:2.75rem] md:[--cell-size:3rem]"
/>
```

### 周数显示

使用 `showWeekNumber` 属性显示周数。

<ComponentPreview
  styleName="base-nova"
  name="calendar-week-numbers"
  previewClassName="h-96"
/>

## 从右到左（RTL）

要启用 shadcn/ui 的 RTL 支持，请参阅 [RTL 配置指南](/docs/rtl)。

另请参阅 [伊斯兰历指南](#波斯历--伊斯兰历--贾拉利历) 以启用波斯历 / 伊斯兰历 / 贾拉利历。

<ComponentPreview
  styleName="base-nova"
  name="calendar-rtl"
  direction="rtl"
  previewClassName="h-96"
/>

使用 RTL 时，从 `react-day-picker/locale` 导入语言环境，并将 `locale` 和 `dir` 属性传递给 Calendar 组件：

```tsx showLineNumbers
import { arSA } from "react-day-picker/locale"

;<Calendar
  mode="single"
  selected={date}
  onSelect={setDate}
  locale={arSA}
  dir="rtl"
/>
```

## API 参考

有关 `Calendar` 组件的更多信息，请参阅 [React DayPicker](https://react-day-picker.js.org) 文档。

## 更新日志

### RTL 支持

如果您从旧版本的 `Calendar` 组件升级，需要进行以下更新以添加语言环境支持：

<Steps>

<Step>导入 `Locale` 类型。</Step>

从 `react-day-picker` 导入时添加 `Locale`：

```diff
  import {
    DayPicker,
    getDefaultClassNames,
    type DayButton,
+   type Locale,
  } from "react-day-picker"
```

<Step>为 Calendar 组件添加 `locale` 属性。</Step>

向组件的 props 添加 `locale` 属性：

```diff
  function Calendar({
    className,
    classNames,
    showOutsideDays = true,
    captionLayout = "label",
    buttonVariant = "ghost",
+   locale,
    formatters,
    components,
    ...props
  }: React.ComponentProps<typeof DayPicker> & {
    buttonVariant?: React.ComponentProps<typeof Button>["variant"]
  }) {
```

<Step>将 `locale` 传递给 DayPicker。</Step>

将 `locale` 属性传递给 `DayPicker` 组件：

```diff
    <DayPicker
      showOutsideDays={showOutsideDays}
      className={cn(...)}
      captionLayout={captionLayout}
+     locale={locale}
      formatters={{
        formatMonthDropdown: (date) =>
-         date.toLocaleString("default", { month: "short" }),
+         date.toLocaleString(locale?.code, { month: "short" }),
        ...formatters,
      }}
```

<Step>更新 CalendarDayButton 以接收 locale。</Step>

更新 `CalendarDayButton` 组件签名并传递 `locale`：

```diff
  function CalendarDayButton({
    className,
    day,
    modifiers,
+   locale,
    ...props
- }: React.ComponentProps<typeof DayButton>) {
+ }: React.ComponentProps<typeof DayButton> & { locale?: Partial<Locale> }) {
```

<Step>更新 CalendarDayButton 中的日期格式化。</Step>

使用 `locale?.code` 格式化日期：

```diff
    <Button
      variant="ghost"
      size="icon"
-     data-day={day.date.toLocaleDateString()}
+     data-day={day.date.toLocaleDateString(locale?.code)}
      ...
    />
```

<Step>将 locale 传递给 DayButton 组件。</Step>

更新 `DayButton` 组件使用，传递 `locale` 属性：

```diff
      components={{
        ...
-       DayButton: CalendarDayButton,
+       DayButton: ({ ...props }) => (
+         <CalendarDayButton locale={locale} {...props} />
+       ),
        ...
      }}
```

<Step>更新支持 RTL 的 CSS 类。</Step>

将方向性类替换为逻辑属性以改善 RTL 支持：

```diff
  // 在 day 类名中：
- [&:last-child[data-selected=true]_button]:rounded-r-(--cell-radius)
+ [&:last-child[data-selected=true]_button]:rounded-e-(--cell-radius)
- [&:nth-child(2)[data-selected=true]_button]:rounded-l-(--cell-radius)
+ [&:nth-child(2)[data-selected=true]_button]:rounded-s-(--cell-radius)
- [&:first-child[data-selected=true]_button]:rounded-l-(--cell-radius)
+ [&:first-child[data-selected=true]_button]:rounded-s-(--cell-radius)

  // 在 range_start 类名中：
- rounded-l-(--cell-radius) ... after:right-0
+ rounded-s-(--cell-radius) ... after:end-0

  // 在 range_end 类名中：
- rounded-r-(--cell-radius) ... after:left-0
+ rounded-e-(--cell-radius) ... after:start-0

  // 在 CalendarDayButton 类名中：
- data-[range-end=true]:rounded-r-(--cell-radius)
+ data-[range-end=true]:rounded-e-(--cell-radius)
- data-[range-start=true]:rounded-l-(--cell-radius)
+ data-[range-start=true]:rounded-s-(--cell-radius)
```

</Steps>

应用这些更改后，您可以使用 `locale` 属性提供特定语言环境的格式化：

```tsx
import { enUS } from "react-day-picker/locale"

;<Calendar mode="single" selected={date} onSelect={setDate} locale={enUS} />
```
